define(["jquery","jqueryui","local_roomsupport/select2"],function(a,b,c){"use strict";function d(){e(),f(),g(),h()}function e(){var b=M.cfg.wwwroot;a(".editRpi").click(function(){a("#savePiBtn").unbind();var c=a(this).data("id");a.ajax({url:b+"/local/roomsupport/ajax/dashboard.php?action=getInfo&id="+c,dataType:"json",success:function(b){console.log(b),a("#piId").val(c),a("#buildingLongName").val(b.building_longname),a("#buildingShortName").val(b.building_shortname),a("#roomNumber").val(b.room_number),a("#faqId").val(b.faqid)},error:function(a){console.log(a)}}),a("#editModal").modal({show:!0,focus:!0}),a("#savePiBtn").click(function(){var c=a("#editPiForm").serialize();console.log(c),a.ajax({url:b+"/local/roomsupport/ajax/dashboard.php?action=save",data:c,dataType:"html",success:function(b){console.log(b),a("#raspberryPiContainer").html(b),a("#editModal").modal("hide"),d()},error:function(a){console.log(a)}})})})}function f(){var b=M.cfg.wwwroot;a(".deleteRpi").click(function(){var c=a(this).data("id");console.log(c);var d=M.util.get_string("delete_confirmation","local_roomsupport");a("#delete-content").html(d),a("#deleteModal").modal({show:!0,focus:!0}),a("#deleteBtn").click(function(){a.ajax({url:b+"/local/roomsupport/ajax/dashboard.php?action=delete&id="+c,dataType:"text",success:function(a){location.reload()},error:function(a){console.log(a)}})})})}function g(){var b=M.cfg.wwwroot;a(".rebootRpi").click(function(){a(".rebootRpi").unbind();var c=a(this).data("id");console.log(c),a.ajax({url:b+"/local/roomsupport/ajax/dashboard.php?action=reboot&id="+c,dataType:"text",success:function(a){alert("System is rebooting"),d()},error:function(a){console.log(a)}})})}function h(){var b=M.cfg.wwwroot;setInterval(function(){a(".modal").modal("hide"),a.ajax({url:b+"/local/roomsupport/ajax/dashboard.php?action=reload",dataType:"html",success:function(b){a("#deviceContainer").html(b),d()},error:function(a){console.log(a)}})},12e4)}return{init:function(){d()}}});