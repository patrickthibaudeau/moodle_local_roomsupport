
/*!
 * HTML5 export buttons for Buttons and DataTables.
 * 2016 SpryMedia Ltd - datatables.net/license
 *
 * FileSaver.js (1.3.3) - MIT license
 * Copyright © 2016 Eli Grey - http://eligrey.com
 */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery","local_mprt_plus/datatable"],function(b){return a(b,window,document)})}else{a(jQuery,window,document)}}(function(a,i,q,d){var o=a.fn.dataTable;function c(){return jszip||i.JSZip}function s(){return pdfmake||i.pdfMake}var m=(function(G){if(typeof G==="undefined"||typeof navigator!=="undefined"&&/MSIE [1-9]\./.test(navigator.userAgent)){return}var H=G.document,D=function(){return G.URL||G.webkitURL||G},J=H.createElementNS("http://www.w3.org/1999/xhtml","a"),z="download" in J,K=function(N){var M=new MouseEvent("click");N.dispatchEvent(M)},B=/constructor/i.test(G.HTMLElement)||G.safari,L=/CriOS\/[\d]+/.test(navigator.userAgent),A=function(M){(G.setImmediate||G.setTimeout)(function(){throw M},0)},F="application/octet-stream",y=1000*40,I=function(N){var M=function(){if(typeof N==="string"){D().revokeObjectURL(N)}else{N.remove()}};setTimeout(M,y)},E=function(N,M,Q){M=[].concat(M);var P=M.length;while(P--){var R=N["on"+M[P]];if(typeof R==="function"){try{R.call(N,Q||N)}catch(O){A(O)}}}},x=function(M){if(/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(M.type)){return new Blob([String.fromCharCode(65279),M],{type:M.type})}return M},w=function(M,N,O){if(!O){M=x(M)}var Q=this,T=M.type,P=T===F,R,S=function(){E(Q,"writestart progress write writeend".split(" "))},U=function(){if((L||(P&&B))&&G.FileReader){var V=new FileReader();V.onloadend=function(){var Y=L?V.result:V.result.replace(/^data:[^;]*;/,"data:attachment/file;");var X=G.open(Y,"_blank");if(!X){G.location.href=Y}Y=d;Q.readyState=Q.DONE;S()};V.readAsDataURL(M);Q.readyState=Q.INIT;return}if(!R){R=D().createObjectURL(M)}if(P){G.location.href=R}else{var W=G.open(R,"_blank");if(!W){G.location.href=R}}Q.readyState=Q.DONE;S();I(R)};Q.readyState=Q.INIT;if(z){R=D().createObjectURL(M);setTimeout(function(){J.href=R;J.download=N;K(J);S();I(R);Q.readyState=Q.DONE});return}U()},t=w.prototype,C=function(N,O,M){return new w(N,O||N.name||"download",M)};if(typeof navigator!=="undefined"&&navigator.msSaveOrOpenBlob){return function(N,O,M){O=O||N.name||"download";if(!M){N=x(N)}return navigator.msSaveOrOpenBlob(N,O)}}t.abort=function(){};t.readyState=t.INIT=0;t.WRITING=1;t.DONE=2;t.error=t.onwritestart=t.onprogress=t.onwrite=t.onabort=t.onerror=t.onwriteend=null;return C}(typeof self!=="undefined"&&self||typeof i!=="undefined"&&i||this.content));o.fileSave=m;var l=function(t){var w="Sheet1";if(t.sheetName){w=t.sheetName.replace(/[\[\]\*\/\\\?\:]/g,"")}return w};var h=function(t){return t.newline?t.newline:navigator.userAgent.match(/Windows/)?"\r\n":"\n"};var v=function(x,y){var F=h(y);var B=x.buttons.exportData(y.exportOptions);var w=y.fieldBoundary;var D=y.fieldSeparator;var z=new RegExp(w,"g");var I=y.escapeChar!==d?y.escapeChar:"\\";var t=function(K){var M="";for(var L=0,J=K.length;L<J;L++){if(L>0){M+=D}M+=w?w+(""+K[L]).replace(z,I+w)+w:K[L]}return M};var C=y.header?t(B.header)+F:"";var G=y.footer&&B.footer?F+t(B.footer):"";var E=[];for(var A=0,H=B.body.length;A<H;A++){E.push(t(B.body[A]))}return{str:C+E.join(F)+G,rows:E.length}};var r=function(){var w=navigator.userAgent.indexOf("Safari")!==-1&&navigator.userAgent.indexOf("Chrome")===-1&&navigator.userAgent.indexOf("Opera")===-1;if(!w){return false}var t=navigator.userAgent.match(/AppleWebKit\/(\d+\.\d+)/);if(t&&t.length>1&&t[1]*1<603.1){return true}return false};function e(z){var y="A".charCodeAt(0);var w="Z".charCodeAt(0);var t=w-y+1;var x="";while(z>=0){x=String.fromCharCode(z%t+y)+x;z=Math.floor(z/t)-1}return x}try{var f=new XMLSerializer();var u}catch(n){}function j(t,w){if(u===d){u=f.serializeToString(a.parseXML(p["xl/worksheets/sheet1.xml"])).indexOf("xmlns:r")===-1}a.each(w,function(x,y){if(a.isPlainObject(y)){var z=t.folder(x);j(z,y)}else{if(u){var F=y.childNodes[0];var A,H;var G=[];for(A=F.attributes.length-1;A>=0;A--){var E=F.attributes[A].nodeName;var B=F.attributes[A].nodeValue;if(E.indexOf(":")!==-1){G.push({name:E,value:B});F.removeAttribute(E)}}for(A=0,H=G.length;A<H;A++){var C=y.createAttribute(G[A].name.replace(":","_dt_b_namespace_token_"));C.value=G[A].value;F.setAttributeNode(C)}}var D=f.serializeToString(y);if(u){if(D.indexOf("<?xml")===-1){D='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+D}D=D.replace(/_dt_b_namespace_token_/g,":")}D=D.replace(/<([^<>]*?) xmlns=""([^<>]*?)>/g,"<$1 $2>");t.file(x,D)}})}function g(x,y,t){var w=x.createElement(y);if(t){if(t.attr){a(w).attr(t.attr)}if(t.children){a.each(t.children,function(z,A){w.appendChild(A)})}if(t.text!==null&&t.text!==d){w.appendChild(x.createTextNode(t.text))}}return w}function k(x,w){var B=x.header[w].length;var z,t,A;if(x.footer&&x.footer[w].length>B){B=x.footer[w].length}for(var y=0,D=x.body.length;y<D;y++){var C=x.body[y][w];A=C!==null&&C!==d?C.toString():"";if(A.indexOf("\n")!==-1){t=A.split("\n");t.sort(function(F,E){return E.length-F.length});z=t[0].length}else{z=A.length}if(z>B){B=z}if(B>40){return 52}}B*=1.3;return B>6?B:6}var p={"_rels/.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>',"xl/_rels/workbook.xml.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/></Relationships>',"[Content_Types].xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="xml" ContentType="application/xml" /><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml" /><Default Extension="jpeg" ContentType="image/jpeg" /><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml" /><Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml" /><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml" /></Types>',"xl/workbook.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="24816"/><workbookPr showInkAnnotation="0" autoCompressPictures="0"/><bookViews><workbookView xWindow="0" yWindow="0" windowWidth="25600" windowHeight="19020" tabRatio="500"/></bookViews><sheets><sheet name="" sheetId="1" r:id="rId1"/></sheets></workbook>',"xl/worksheets/sheet1.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><sheetData/><mergeCells count="0"/></worksheet>',"xl/styles.xml":'<?xml version="1.0" encoding="UTF-8"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><numFmts count="6"><numFmt numFmtId="164" formatCode="#,##0.00_- [$$-45C]"/><numFmt numFmtId="165" formatCode="&quot;£&quot;#,##0.00"/><numFmt numFmtId="166" formatCode="[$€-2] #,##0.00"/><numFmt numFmtId="167" formatCode="0.0%"/><numFmt numFmtId="168" formatCode="#,##0;(#,##0)"/><numFmt numFmtId="169" formatCode="#,##0.00;(#,##0.00)"/></numFmts><fonts count="5" x14ac:knownFonts="1"><font><sz val="11" /><name val="Calibri" /></font><font><sz val="11" /><name val="Calibri" /><color rgb="FFFFFFFF" /></font><font><sz val="11" /><name val="Calibri" /><b /></font><font><sz val="11" /><name val="Calibri" /><i /></font><font><sz val="11" /><name val="Calibri" /><u /></font></fonts><fills count="6"><fill><patternFill patternType="none" /></fill><fill><patternFill patternType="none" /></fill><fill><patternFill patternType="solid"><fgColor rgb="FFD9D9D9" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="FFD99795" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="ffc6efce" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="ffc6cfef" /><bgColor indexed="64" /></patternFill></fill></fills><borders count="2"><border><left /><right /><top /><bottom /><diagonal /></border><border diagonalUp="false" diagonalDown="false"><left style="thin"><color auto="1" /></left><right style="thin"><color auto="1" /></right><top style="thin"><color auto="1" /></top><bottom style="thin"><color auto="1" /></bottom><diagonal /></border></borders><cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" /></cellStyleXfs><cellXfs count="67"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="left"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="center"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="right"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="fill"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment textRotation="90"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment wrapText="1"/></xf><xf numFmtId="9"   fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="164" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="165" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="166" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="167" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="168" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="169" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="3" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="4" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="1" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="2" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/></cellXfs><cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0" /></cellStyles><dxfs count="0" /><tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4" /></styleSheet>'};var b=[{match:/^\-?\d+\.\d%$/,style:60,fmt:function(t){return t/100}},{match:/^\-?\d+\.?\d*%$/,style:56,fmt:function(t){return t/100}},{match:/^\-?\$[\d,]+.?\d*$/,style:57},{match:/^\-?£[\d,]+.?\d*$/,style:58},{match:/^\-?€[\d,]+.?\d*$/,style:59},{match:/^\-?\d+$/,style:65},{match:/^\-?\d+\.\d{2}$/,style:66},{match:/^\([\d,]+\)$/,style:61,fmt:function(t){return -1*t.replace(/[\(\)]/g,"")}},{match:/^\([\d,]+\.\d{2}\)$/,style:62,fmt:function(t){return -1*t.replace(/[\(\)]/g,"")}},{match:/^\-?[\d,]+$/,style:63},{match:/^\-?[\d,]+\.\d{2}$/,style:64}];o.ext.buttons.copyHtml5={className:"buttons-copy buttons-html5",text:function(t){return t.i18n("buttons.copy","Copy")},action:function(G,x,D,A){this.processing(true);var F=this;var C=v(x,A);var z=x.buttons.exportInfo(A);var B=h(A);var y=C.str;var H=a("<div/>").css({height:1,width:1,overflow:"hidden",position:"fixed",top:0,left:0});if(z.title){y=z.title+B+B+y}if(z.messageTop){y=z.messageTop+B+B+y}if(z.messageBottom){y=y+B+B+z.messageBottom}if(A.customize){y=A.customize(y,A,x)}var I=a("<textarea readonly/>").val(y).appendTo(H);if(q.queryCommandSupported("copy")){H.appendTo(x.table().container());I[0].focus();I[0].select();try{var E=q.execCommand("copy");H.remove();if(E){x.buttons.info(x.i18n("buttons.copyTitle","Copy to clipboard"),x.i18n("buttons.copySuccess",{1:"Copied one row to clipboard",_:"Copied %d rows to clipboard"},C.rows),2000);this.processing(false);return}}catch(K){}}var L=a("<span>"+x.i18n("buttons.copyKeys","Press <i>ctrl</i> or <i>\u2318</i> + <i>C</i> to copy the table data<br>to your system clipboard.<br><br>To cancel, click this message or press escape.")+"</span>").append(H);x.buttons.info(x.i18n("buttons.copyTitle","Copy to clipboard"),L,0);I[0].focus();I[0].select();var w=a(L).closest(".dt-button-info");var J=function(){w.off("click.buttons-copy");a(q).off(".buttons-copy");x.buttons.info(false)};w.on("click.buttons-copy",J);a(q).on("keydown.buttons-copy",function(t){if(t.keyCode===27){J();F.processing(false)}}).on("copy.buttons-copy cut.buttons-copy",function(){J();F.processing(false)})},exportOptions:{},fieldSeparator:"\t",fieldBoundary:"",header:true,footer:false,title:"*",messageTop:"*",messageBottom:"*"};o.ext.buttons.csvHtml5={bom:false,className:"buttons-csv buttons-html5",available:function(){return i.FileReader!==d&&i.Blob},text:function(t){return t.i18n("buttons.csv","CSV")},action:function(A,y,x,w){this.processing(true);var t=v(y,w).str;var z=y.buttons.exportInfo(w);var B=w.charset;if(w.customize){t=w.customize(t,w,y)}if(B!==false){if(!B){B=q.characterSet||q.charset}if(B){B=";charset="+B}}else{B=""}if(w.bom){t="\ufeff"+t}m(new Blob([t],{type:"text/csv"+B}),z.filename,true);this.processing(false)},filename:"*",extension:".csv",exportOptions:{},fieldSeparator:",",fieldBoundary:'"',escapeChar:'"',charset:null,header:true,footer:false};o.ext.buttons.excelHtml5={className:"buttons-excel buttons-html5",available:function(){return i.FileReader!==d&&c()!==d&&!r()&&f},text:function(t){return t.i18n("buttons.excel","Excel")},action:function(O,G,t,P){this.processing(true);var C=this;var M=0;var J=function(T){var U=p[T];return a.parseXML(U)};var z=J("xl/worksheets/sheet1.xml");var E=z.getElementsByTagName("sheetData")[0];var A={_rels:{".rels":J("_rels/.rels")},xl:{_rels:{"workbook.xml.rels":J("xl/_rels/workbook.xml.rels")},"workbook.xml":J("xl/workbook.xml"),"styles.xml":J("xl/styles.xml"),worksheets:{"sheet1.xml":z}},"[Content_Types].xml":J("[Content_Types].xml")};var S=G.buttons.exportData(P.exportOptions);var R,x;var w=function(ad){R=M+1;x=g(z,"row",{attr:{r:R}});for(var Y=0,ac=ad.length;Y<ac;Y++){var V=e(Y)+""+R;var aa=null;if(ad[Y]===null||ad[Y]===d||ad[Y]===""){if(P.createEmptyCells===true){ad[Y]=""}else{continue}}var T=ad[Y];ad[Y]=a.trim(ad[Y]);for(var X=0,U=b.length;X<U;X++){var Z=b[X];if(ad[Y].match&&!ad[Y].match(/^0\d+/)&&ad[Y].match(Z.match)){var W=ad[Y].replace(/[^\d\.\-]/g,"");if(Z.fmt){W=Z.fmt(W)}aa=g(z,"c",{attr:{r:V,s:Z.style},children:[g(z,"v",{text:W})]});break}}if(!aa){if(typeof ad[Y]==="number"||(ad[Y].match&&ad[Y].match(/^-?\d+(\.\d+)?$/)&&!ad[Y].match(/^0\d+/))){aa=g(z,"c",{attr:{t:"n",r:V},children:[g(z,"v",{text:ad[Y]})]})}else{var ab=!T.replace?T:T.replace(/[\x00-\x09\x0B\x0C\x0E-\x1F\x7F-\x9F]/g,"");aa=g(z,"c",{attr:{t:"inlineStr",r:V},children:{row:g(z,"is",{children:{row:g(z,"t",{text:ab,attr:{"xml:space":"preserve"}})}})}})}}x.appendChild(aa)}E.appendChild(x);M++};a("sheets sheet",A.xl["workbook.xml"]).attr("name",l(P));if(P.customizeData){P.customizeData(S)}var K=function(U,V){var T=a("mergeCells",z);T[0].appendChild(g(z,"mergeCell",{attr:{ref:"A"+U+":"+e(V)+U}}));T.attr("count",parseFloat(T.attr("count"))+1);a("row:eq("+(U-1)+") c",z).attr("s","51")};var Q=G.buttons.exportInfo(P);if(Q.title){w([Q.title],M);K(M,S.header.length-1)}if(Q.messageTop){w([Q.messageTop],M);K(M,S.header.length-1)}if(P.header){w(S.header,M);a("row:last c",z).attr("s","2")}for(var I=0,H=S.body.length;I<H;I++){w(S.body[I],M)}if(P.footer&&S.footer){w(S.footer,M);a("row:last c",z).attr("s","2")}if(Q.messageBottom){w([Q.messageBottom],M);K(M,S.header.length-1)}var F=g(z,"cols");a("worksheet",z).prepend(F);for(var L=0,y=S.header.length;L<y;L++){F.appendChild(g(z,"col",{attr:{min:L+1,max:L+1,width:k(S,L),customWidth:1}}))}if(P.customize){P.customize(A,P,G)}if(a("mergeCells",z).children().length===0){a("mergeCells",z).remove()}var D=c();var N=new D();var B={type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};j(N,A);if(N.generateAsync){N.generateAsync(B).then(function(T){m(T,Q.filename);C.processing(false)})}else{m(N.generate(B),Q.filename);this.processing(false)}},filename:"*",extension:".xlsx",exportOptions:{},header:true,footer:false,title:"*",messageTop:"*",messageBottom:"*",createEmptyCells:false};o.ext.buttons.pdfHtml5={className:"buttons-pdf buttons-html5",available:function(){return i.FileReader!==d&&s()},text:function(t){return t.i18n("buttons.pdf","PDF")},action:function(D,w,B,y){this.processing(true);var C=this;var A=w.buttons.exportData(y.exportOptions);var x=w.buttons.exportInfo(y);var G=[];if(y.header){G.push(a.map(A.header,function(H){return{text:typeof H==="string"?H:H+"",style:"tableHeader"}}))}for(var z=0,F=A.body.length;z<F;z++){G.push(a.map(A.body[z],function(H){return{text:typeof H==="string"?H:H+"",style:z%2?"tableBodyEven":"tableBodyOdd"}}))}if(y.footer&&A.footer){G.push(a.map(A.footer,function(H){return{text:typeof H==="string"?H:H+"",style:"tableFooter"}}))}var E={pageSize:y.pageSize,pageOrientation:y.orientation,content:[{table:{headerRows:1,body:G},layout:"noBorders"}],styles:{tableHeader:{bold:true,fontSize:11,color:"white",fillColor:"#2d4154",alignment:"center"},tableBodyEven:{},tableBodyOdd:{fillColor:"#f3f3f3"},tableFooter:{bold:true,fontSize:11,color:"white",fillColor:"#2d4154"},title:{alignment:"center",fontSize:15},message:{}},defaultStyle:{fontSize:10}};if(x.messageTop){E.content.unshift({text:x.messageTop,style:"message",margin:[0,0,0,12]})}if(x.messageBottom){E.content.push({text:x.messageBottom,style:"message",margin:[0,0,0,12]})}if(x.title){E.content.unshift({text:x.title,style:"title",margin:[0,0,0,12]})}if(y.customize){y.customize(E,y,w)}var t=s().createPdf(E);if(y.download==="open"&&!r()){t.open()}else{t.download(x.filename)}this.processing(false)},title:"*",filename:"*",extension:".pdf",exportOptions:{},orientation:"portrait",pageSize:"A4",header:true,footer:false,messageTop:"*",messageBottom:"*",customize:null,download:"download"};return o.Buttons}));